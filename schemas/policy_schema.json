{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "required": ["rules"],
  "properties": {
    "rules": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["name", "allow_tools"],
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the policy rule"
          },
          "description": {
            "type": "string",
            "description": "Description of what this rule controls"
          },
          "model_patterns": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "List of model ID patterns this rule applies to (supports wildcards)"
          },
          "allow_tools": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "List of tools allowed by this rule (supports wildcards)"
          },
          "max_calls_per_session": {
            "type": "integer",
            "minimum": 1,
            "description": "Maximum number of tool calls per session"
          },
          "max_calls_per_minute": {
            "type": "integer",
            "minimum": 1,
            "description": "Maximum number of tool calls per minute"
          },
          "active_hours": {
            "type": "string",
            "pattern": "^[0-9]{1,2}:[0-9]{2}-[0-9]{1,2}:[0-9]{2}$",
            "description": "Time range when this rule is active, in format HH:MM-HH:MM"
          }
        }
      }
    },
    "comments": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Optional comments about this policy file"
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "Timestamp when this policy was created"
    },
    "version": {
      "type": "string",
      "description": "Version identifier for this policy"
    }
  }
}